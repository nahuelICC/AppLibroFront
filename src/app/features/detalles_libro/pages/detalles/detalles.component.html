<div class="flex flex-col md:flex-row gap-6 p-6 min-h-screen">
  <!-- üìñ Secci√≥n Izquierda: Informaci√≥n del Libro y Rese√±as -->
  <div class="md:w-2/3 p-6 flex flex-col">
    <p class="text-gray-500 mb-4">{{ libro?.genero }}</p>
    <!-- T√≠tulo y Autor -->
    <h1 class="text-2xl font-bold">{{ libro?.titulo }}</h1>
    <p class="text-gray-500 text-lg mt-2">{{ libro?.autor }}</p>

    <!-- Contenedor de la imagen y la descripci√≥n -->
    <div class="flex flex-col md:flex-row gap-6">
      <!-- Imagen de la Portada -->
      <img [src]="libro?.portada || 'assets/default-cover.jpg'" alt="Portada del libro"
           class="w-full max-w-xs mt-4 shadow-md rounded-lg">

      <!-- üìÑ Descripci√≥n del Libro -->
      <div>
        <h2 class="text-xl font-semibold mt-10">Sinopsis</h2>
        <p class="text-gray-700">{{ libro?.descripcion }}</p>
      </div>
    </div>

    <!-- üì¢ Secci√≥n de Rese√±as -->
    <h2 class="text-xl font-semibold mt-6">Rese√±as</h2>

    <!-- ‚≠ê Puntuaci√≥n promedio -->
    <div class="mt-4 flex items-center justify-between w-4/5">
      <div class="flex items-center">
        <h3 class="text-3xl font-bold mr-2">{{ averageRating }}</h3>
        <div class="flex">
          <ng-container *ngFor="let star of starsArray">
            <span [class]="star <= averageRating ? 'text-black' : 'text-gray-400'">‚òÖ</span>
          </ng-container>
        </div>
      </div>
      <p class="text-gray-500">{{ totalReviews }} rese√±as</p>
    </div>

    <!-- üìä Barra de distribuci√≥n de estrellas -->
    <div class="mt-4 mb-4 space-y-1">
      <div *ngFor="let rating of ratingDistribution; let i = index" class="flex items-center justify-between">
        <div class="flex items-center w-4/5">
          <span class="w-6 text-center mr-2">{{ rating.stars }}</span>
          <div class="flex-1 bg-gray-200 rounded-full h-2 relative">
            <div class="bg-black h-2 rounded-full absolute top-0 left-0" [style.width.%]="rating.percentage"></div>
          </div>
          <span class="ml-2 text-sm">{{ rating.percentage }}%</span>
        </div>
      </div>
    </div>

    <!-- Bot√≥n para mostrar el formulario -->
    <app-boton [label]="'Dejar rese√±a'" [color]="'#078080'" class="mt-4 w-full" (click)="toggleFormulario()"></app-boton>

    <!-- Formulario oculto hasta que se presione el bot√≥n -->
    <div *ngIf="mostrarFormulario" class="mt-4">
      <h3 class="text-lg font-semibold">Escribe tu opini√≥n</h3>
      <form (submit)="submitReview()" class="mt-4">
        <textarea [(ngModel)]="nuevaResenya.texto" name="texto" placeholder="Escribe tu opini√≥n..."
                  class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>

        <label class="block mt-2">Valoraci√≥n:</label>
        <select [(ngModel)]="nuevaResenya.valoracion" name="valoracion"
                class="w-full mb-4 p-2 border rounded-md">
          <option *ngFor="let num of [1, 2, 3, 4, 5]" [value]="num">{{ num }} estrellas</option>
        </select>

        <app-boton [label]="'Enviar Rese√±a'" [color]="'#078080'" class="mt-4 w-full"></app-boton>
      </form>
    </div>

    <!-- üìù Lista de Rese√±as -->
    <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-10">
      <app-resena *ngFor="let review of resenyas"
                  [nombre]="review.nombre"
                  [apellido]="review.apellido"
                  [date]="review.fecha"
                  [rating]="review.valoracion"
                  [comment]="review.texto">
      </app-resena>
    </div>
  </div>

  <!-- üí∞ Secci√≥n Derecha: Precio y detalles de compra -->
  <div class="md:w-1/3 p-6 flex flex-col" style="max-height: 500px; overflow-y: auto;">
    <app-detalle-precio
      *ngIf="libro"
      [precios]="{
                    blanda: libro?.precioTapaBlanda ? +libro.precioTapaBlanda : null,
                    dura: libro?.precioTapaDura ? +libro.precioTapaDura : null
                }"
      [tiposTapa]="tiposTapa"
      [libroId]="libroId">
    </app-detalle-precio>
  </div>
</div>
